import{d as I,r as b,x as O,c as k,w as C,a as l,o as i,b as c,e as o,t as u,f as P,g as p,v as m,u as d,h as L,F as V,i as z,W as A,j as h,k as Y,l as H}from"./app-Djf13ouE.js";const G={key:0,class:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50"},J=["src"],K={class:"min-h-screen bg-gray-50 py-6 px-4 sm:px-6 flex justify-center"},Z={key:0,class:"w-full max-w-3xl bg-white rounded-2xl shadow-lg p-6 sm:p-8 grid grid-cols-1 md:grid-cols-2 gap-6"},ee={class:"space-y-4"},te={class:"text-xl sm:text-2xl font-bold text-center text-[#002B5C] mb-4"},oe={key:0,class:"bg-red-100 text-red-800 p-2 rounded-lg text-sm"},se={key:1,class:"bg-red-100 text-red-800 p-2 rounded-lg text-sm"},re=["min"],ne=["min"],le={class:"space-y-2"},ie={class:"text-sm text-gray-600"},ae={key:0},de={key:0},ue=["src"],ce={key:1,class:"text-gray-700 text-sm"},pe={key:1,class:"text-gray-500 italic text-sm"},me={key:2,class:"text-red-600 text-sm mt-1"},fe={key:0,class:"mt-4"},ge={class:"text-sm font-semibold text-gray-700 mb-2"},be={class:"overflow-x-auto"},he={key:0,class:"min-w-full bg-white border rounded"},ve={class:"px-2 py-1 text-sm"},_e={class:"px-2 py-1 text-sm"},ye={key:1,class:"text-xs text-gray-500 italic"},ke=["disabled"],we={class:"space-y-4"},xe={class:"flex justify-center"},De=["src"],Se={key:0,class:"mt-4"},Ce={class:"overflow-x-auto"},$e={class:"min-w-full border rounded"},qe={class:"px-3 py-3 text-center"},Be=["src"],Te={class:"px-3 py-3 text-center"},Ve=["src"],je={class:"px-3 py-3 text-center"},Qe=["src"],Re={class:"px-3 py-3 text-center"},We=["src"],Ue={class:"px-3 py-3 text-center"},Ne=["src"],Fe={key:1,class:"text-red-600 font-medium text-center mt-10"},Xe={class:"bg-[#182235] text-gray-200 text-center sm:text-left py-8 px-6 border-t border-gray-700"},Ee={class:"border-t border-gray-700 mt-8 pt-4 text-center text-xs text-gray-400"},Ie=I({__name:"Booking",props:{shop:{},errors:{},bookings:{}},setup(j){const w=b(!1),$=b("");function f(t){t&&($.value=t,w.value=!0)}const g=j,r=O({name:"",email:"",size_of_the_car:"",contact_no:"",time_of_booking:"",date_of_booking:"",slot_number:1,services_offered:""}),_=b(""),y=b(""),x=b(g.bookings||[]),Q=k(()=>r.date_of_booking?new Date(r.date_of_booking).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""),q=k(()=>{if(!r.date_of_booking)return[];const t=r.date_of_booking,e=x.value.filter(n=>n.date_of_booking===t),s={};return e.forEach(n=>{const a=`${n.time_of_booking}-${n.slot_number}`;s[a]||(s[a]={id:n.id,time:n.time_of_booking,slot:n.slot_number,takenBy:""}),n.name?s[a].takenBy=s[a].takenBy&&s[a].takenBy!==n.name?"Multiple":n.name:s[a].takenBy||(s[a].takenBy="Unknown")}),Object.values(s).sort((n,a)=>new Date(`2000-01-01T${n.time}:00`).getTime()-new Date(`2000-01-01T${a.time}:00`).getTime())}),B=k(()=>{if(!r.date_of_booking||!r.time_of_booking||!r.slot_number)return!1;const t=new Date(`${r.date_of_booking}T${r.time_of_booking}:00`),e=new Date(t.getTime()+3*60*60*1e3);return x.value.some(s=>{const n=new Date(`${s.date_of_booking}T${s.time_of_booking}:00`),a=new Date(n.getTime()+3*60*60*1e3);return s.slot_number===r.slot_number&&n<e&&t<a})}),T=async t=>{var n;if(!t||!((n=g.shop)!=null&&n.id))return;const e=[new Date(t),new Date(t).setDate(new Date(t).getDate()-1),new Date(t).setDate(new Date(t).getDate()+1)].map(a=>new Date(a).toISOString().split("T")[0]),s=[];for(const a of[...new Set(e)])try{const D=await H.get(`/shops/${g.shop.id}/availability?date=${a}`);s.push(...D.data.bookings)}catch{}x.value=s.filter((a,D,M)=>D===M.findIndex(S=>S.date_of_booking===a.date_of_booking&&S.time_of_booking===a.time_of_booking&&S.slot_number===a.slot_number))},R=()=>A.visit(route("dashboard")),W=()=>{var t;if(_.value="",y.value="",!((t=g.shop)!=null&&t.id)){_.value="Invalid shop ID";return}if(B.value){y.value="This slot is already booked";return}r.post(`/customer/book/${g.shop.id}/payment`)},U=window.location.origin;function N(t){var e;return(e=t.logo)!=null&&e.startsWith("http")?t.logo:`/storage/${t.logo}`||"/images/default-carwash.png"}function F(t){const e=t.target;e&&(e.src=`${U}/images/default-carwash.png`)}C(()=>r.date_of_booking,T),C(()=>g.shop,t=>{t!=null&&t.id&&r.date_of_booking&&T(r.date_of_booking)});function X(t){const e=t.target;e.value=e.value.replace(/\D/g,"").slice(0,11),r.contact_no=e.value}const E=k(()=>{const t=new Date,e=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${s}-${n}`}),v=b("00:00");return C(()=>r.date_of_booking,t=>{if(!t)return;const e=new Date;if(new Date(t).toDateString()===e.toDateString()){const n=e.getHours().toString().padStart(2,"0"),a=e.getMinutes().toString().padStart(2,"0");v.value=`${n}:${a}`,r.time_of_booking<v.value&&(r.time_of_booking=v.value)}else v.value="00:00"},{immediate:!0}),(t,e)=>(i(),l(V,null,[w.value?(i(),l("div",G,[o("img",{src:$.value,alt:"QR Code Preview",class:"max-h-[80vh] rounded-xl shadow-2xl border-4 border-white"},null,8,J),o("button",{onClick:e[0]||(e[0]=s=>w.value=!1),class:"absolute top-6 right-8 text-white text-3xl font-bold"}," ✕ ")])):c("",!0),o("div",K,[t.shop?(i(),l("div",Z,[o("div",ee,[o("h1",te,"Book at "+u(t.shop.name),1),_.value?(i(),l("div",oe,u(_.value),1)):c("",!0),y.value?(i(),l("div",se,u(y.value),1)):c("",!0),o("form",{onSubmit:P(W,["prevent"]),class:"space-y-4"},[p(o("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=s=>d(r).name=s),placeholder:"Your Name",class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:""},null,512),[[m,d(r).name]]),p(o("input",{type:"email","onUpdate:modelValue":e[2]||(e[2]=s=>d(r).email=s),placeholder:"Email Address",class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:""},null,512),[[m,d(r).email]]),p(o("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>d(r).size_of_the_car=s),class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:""},[...e[15]||(e[15]=[o("option",{value:""},"Select Car Types",-1),o("option",null,"HatchBack",-1),o("option",null,"Sedan",-1),o("option",null,"MPV",-1),o("option",null,"SUV",-1),o("option",null,"Pickup",-1),o("option",null,"Van",-1),o("option",null,"Motorcycle",-1)])],512),[[L,d(r).size_of_the_car]]),p(o("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=s=>d(r).contact_no=s),placeholder:"09XXXXXXXXX",class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:"",maxlength:"11",onInput:X},null,544),[[m,d(r).contact_no]]),p(o("input",{type:"date","onUpdate:modelValue":e[5]||(e[5]=s=>d(r).date_of_booking=s),class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:"",min:E.value},null,8,re),[[m,d(r).date_of_booking]]),p(o("input",{type:"time","onUpdate:modelValue":e[6]||(e[6]=s=>d(r).time_of_booking=s),class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:"",min:v.value},null,8,ne),[[m,d(r).time_of_booking]]),o("div",le,[e[16]||(e[16]=o("label",{for:"slot_number",class:"block text-gray-700"},"Slot Number",-1)),p(o("input",{id:"slot_number",type:"number","onUpdate:modelValue":e[7]||(e[7]=s=>d(r).slot_number=s),min:"1",max:"4",class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:""},null,512),[[m,d(r).slot_number]]),o("p",ie,"Selected: Slot "+u(d(r).slot_number||1),1)]),o("div",null,[e[17]||(e[17]=o("label",{class:"block text-sm font-semibold text-gray-700 mb-1"},"Services Offered",-1)),t.shop.services_offered?(i(),l("div",ae,[t.shop.services_offered.match(/\.(jpg|jpeg|png|gif|webp)$/i)||t.shop.services_offered.startsWith("http")?(i(),l("div",de,[o("img",{src:t.shop.services_offered.startsWith("http")?t.shop.services_offered:`/storage/${t.shop.services_offered}`,alt:"Services Offered",class:"h-24 w-24 object-contain rounded border cursor-pointer hover:scale-105 transition",onClick:e[8]||(e[8]=s=>f(t.shop.services_offered.startsWith("http")?t.shop.services_offered:`/storage/${t.shop.services_offered}`))},null,8,ue)])):(i(),l("p",ce,u(t.shop.services_offered),1))])):(i(),l("div",pe,"No services listed")),e[18]||(e[18]=o("label",{class:"block text-sm font-semibold text-gray-700 mt-3"},"Services Requested",-1)),p(o("textarea",{"onUpdate:modelValue":e[9]||(e[9]=s=>d(r).services_offered=s),class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",placeholder:"Specify services you want",rows:"3",required:""},null,512),[[m,d(r).services_offered]]),d(r).errors.services_offered?(i(),l("div",me,u(d(r).errors.services_offered),1)):c("",!0)]),d(r).date_of_booking?(i(),l("div",fe,[o("h3",ge,"Taken Slots on "+u(Q.value)+" (View Only)",1),o("div",be,[q.value.length?(i(),l("table",he,[e[20]||(e[20]=o("thead",{class:"bg-gray-50"},[o("tr",null,[o("th",null,"Time"),o("th",null,"Slot"),o("th",null,"Status")])],-1)),o("tbody",null,[(i(!0),l(V,null,z(q.value,s=>(i(),l("tr",{key:`${s.time}-${s.slot}-${s.id||0}`,class:"bg-red-50 border-l-4 border-red-400"},[o("td",ve,u(s.time),1),o("td",_e,"#"+u(s.slot),1),e[19]||(e[19]=o("td",{class:"px-2 py-1 text-sm text-red-600 font-semibold"},"Taken",-1))]))),128))])])):(i(),l("p",ye,"No taken slots yet."))])])):c("",!0),o("button",{type:"button",onClick:R,class:"w-full bg-gray-500 text-white py-2 rounded hover:bg-gray-600 transition"},"Return"),o("button",{type:"submit",class:"w-full bg-[#FF2D2D] text-white py-2 rounded hover:bg-red-700 transition",disabled:d(r).processing||B.value},"Pay Now",8,ke)],32)]),o("div",we,[e[27]||(e[27]=o("h2",{class:"text-lg font-semibold text-[#002B5C mb-2"},"Shop Details",-1)),o("div",xe,[o("img",{src:N(t.shop),alt:"Car Wash Logo",class:"h-20 w-20 object-contain mb-2",onError:F},null,40,De)]),o("p",null,[e[21]||(e[21]=o("span",{class:"font-semibold"},"Name:",-1)),h(" "+u(t.shop.name),1)]),o("p",null,[e[22]||(e[22]=o("span",{class:"font-semibold"},"Address:",-1)),h(" "+u(t.shop.address),1)]),o("p",null,[e[23]||(e[23]=o("span",{class:"font-semibold"},"District:",-1)),h(" "+u(t.shop.district||"Not specified"),1)]),o("p",null,[e[24]||(e[24]=o("span",{class:"font-semibold"},"Description:",-1)),h(" "+u(t.shop.description||"No description"),1)]),t.shop&&(t.shop.qr_code||t.shop.qr_code2||t.shop.qr_code3||t.shop.qr_code4||t.shop.qr_code5)?(i(),l("div",Se,[e[26]||(e[26]=o("h3",{class:"text-sm font-semibold text-gray-700 mb-2"},"QR Codes",-1)),o("div",Ce,[o("table",$e,[e[25]||(e[25]=o("thead",{class:"bg-gray-50"},[o("tr",null,[o("th",{class:"px-3 py-2 text-center"},"QR Code 1"),o("th",{class:"px-3 py-2 text-center"},"QR Code 2"),o("th",{class:"px-3 py-2 text-center"},"QR Code 3"),o("th",{class:"px-3 py-2 text-center"},"QR Code 4"),o("th",{class:"px-3 py-2 text-center"},"QR Code 5")])],-1)),o("tbody",null,[o("tr",null,[o("td",qe,[t.shop.qr_code?(i(),l("img",{key:0,src:t.shop.qr_code,alt:"QR Code 1",class:"h-12 w-12 object-cover rounded border mx-auto cursor-pointer hover:scale-105 transition",onClick:e[10]||(e[10]=s=>f(t.shop.qr_code))},null,8,Be)):c("",!0)]),o("td",Te,[t.shop.qr_code2?(i(),l("img",{key:0,src:t.shop.qr_code2,alt:"QR Code 2",class:"h-12 w-12 object-cover rounded border mx-auto cursor-pointer hover:scale-105 transition",onClick:e[11]||(e[11]=s=>f(t.shop.qr_code2))},null,8,Ve)):c("",!0)]),o("td",je,[t.shop.qr_code3?(i(),l("img",{key:0,src:t.shop.qr_code3,alt:"QR Code 3",class:"h-12 w-12 object-cover rounded border mx-auto cursor-pointer hover:scale-105 transition",onClick:e[12]||(e[12]=s=>f(t.shop.qr_code3))},null,8,Qe)):c("",!0)]),o("td",Re,[t.shop.qr_code4?(i(),l("img",{key:0,src:t.shop.qr_code4,alt:"QR Code 4",class:"h-12 w-12 object-cover rounded border mx-auto cursor-pointer hover:scale-105 transition",onClick:e[13]||(e[13]=s=>f(t.shop.qr_code4))},null,8,We)):c("",!0)]),o("td",Ue,[t.shop.qr_code5?(i(),l("img",{key:0,src:t.shop.qr_code5,alt:"QR Code 5",class:"h-12 w-12 object-cover rounded border mx-auto cursor-pointer hover:scale-105 transition",onClick:e[14]||(e[14]=s=>f(t.shop.qr_code5))},null,8,Ne)):c("",!0)])])])])])])):c("",!0)])])):(i(),l("div",Fe,"Shop not found."))]),o("footer",Xe,[e[31]||(e[31]=Y('<div class="max-w-6xl mx-auto grid grid-cols-1 sm:grid-cols-3 gap-6"><div><h2 class="text-lg font-bold text-white mb-3">About WashWise</h2><p class="text-sm leading-relaxed"> WashWise is your trusted platform for booking car wash services — connecting customers and business owners for a smoother, cleaner experience every day. </p></div><div><h2 class="text-lg font-bold text-white mb-3">Contact Us</h2><ul class="text-sm space-y-1"><li>📞 +63 992 759 4673</li><li>✉️ washwise00@gmail.com</li></ul></div></div>',1)),o("div",Ee,[h(" © "+u(new Date().getFullYear())+" WashWise. All rights reserved. ",1),e[28]||(e[28]=o("br",{class:"sm:hidden"},null,-1)),e[29]||(e[29]=h(" Developed by ",-1)),e[30]||(e[30]=o("span",{class:"text-[#FF2D2D] font-semibold"},"Washwise Team.",-1))])])],64))}});export{Ie as default};
