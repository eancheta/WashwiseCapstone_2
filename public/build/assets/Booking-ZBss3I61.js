import{d as I,r as v,x as O,c as x,w as C,a as l,o as i,b as p,e,t as c,f as P,g as m,h as u,v as f,u as d,i as L,F as T,j as z,W as A,k as Y,l as H}from"./app-Ck1lZh-2.js";const G={key:0,class:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50"},J=["src"],K={class:"min-h-screen bg-gray-50 py-6 px-4 sm:px-6 flex justify-center"},Z={key:0,class:"w-full max-w-3xl bg-white rounded-2xl shadow-lg p-6 sm:p-8 grid grid-cols-1 md:grid-cols-2 gap-6"},ee={class:"space-y-4"},te={class:"text-xl sm:text-2xl font-bold text-center text-[#002B5C] mb-4"},se={key:0,class:"bg-red-100 text-red-800 p-2 rounded-lg text-sm"},oe={key:1,class:"bg-red-100 text-red-800 p-2 rounded-lg text-sm"},re=["min"],ne=["min"],le={class:"space-y-2"},ie={class:"text-sm text-gray-600"},ae={key:0},de={key:0},ue=["src"],ce={key:1,class:"text-gray-700 text-sm"},pe={key:1,class:"text-gray-500 italic text-sm"},me={key:2,class:"text-red-600 text-sm mt-1"},fe={key:0,class:"mt-4"},ge={class:"text-sm font-semibold text-gray-700 mb-2"},be={class:"overflow-x-auto"},ve={key:0,class:"min-w-full bg-white border rounded"},ye={class:"px-2 py-1 text-sm"},he={class:"px-2 py-1 text-sm"},_e={key:1,class:"text-xs text-gray-500 italic"},xe=["disabled"],ke={class:"space-y-4"},we={class:"flex justify-center"},De=["src"],qe={key:0,class:"mt-4"},Ce={class:"overflow-x-auto"},Se={class:"min-w-full border rounded"},$e={class:"px-3 py-3 text-center"},Be=["src"],Re={class:"px-3 py-3 text-center"},Te=["src"],Ve={class:"px-3 py-3 text-center"},je=["src"],Ne={class:"px-3 py-3 text-center"},Qe=["src"],We={class:"px-3 py-3 text-center"},Ue=["src"],Ee={key:1,class:"text-red-600 font-medium text-center mt-10"},Fe={class:"bg-[#182235] text-gray-200 text-center sm:text-left py-8 px-6 border-t border-gray-700"},Xe={class:"border-t border-gray-700 mt-8 pt-4 text-center text-xs text-gray-400"},Ie=I({__name:"Booking",props:{shop:{},errors:{},bookings:{}},setup(V){const k=v(!1),S=v("");function g(s){s&&(S.value=s,k.value=!0)}const b=V,r=O({name:"",email:"",size_of_the_car:"",contact_no:"",time_of_booking:"",date_of_booking:"",slot_number:1,services_offered:""}),h=v(""),_=v(""),w=v(b.bookings||[]),j=x(()=>r.date_of_booking?new Date(r.date_of_booking).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""),$=x(()=>{if(!r.date_of_booking)return[];const s=r.date_of_booking,t=w.value.filter(n=>n.date_of_booking===s),o={};return t.forEach(n=>{const a=`${n.time_of_booking}-${n.slot_number}`;o[a]||(o[a]={id:n.id,time:n.time_of_booking,slot:n.slot_number,takenBy:""}),n.name?o[a].takenBy=o[a].takenBy&&o[a].takenBy!==n.name?"Multiple":n.name:o[a].takenBy||(o[a].takenBy="Unknown")}),Object.values(o).sort((n,a)=>new Date(`2000-01-01T${n.time}:00`).getTime()-new Date(`2000-01-01T${a.time}:00`).getTime())}),B=x(()=>{if(!r.date_of_booking||!r.time_of_booking||!r.slot_number)return!1;const s=new Date(`${r.date_of_booking}T${r.time_of_booking}:00`),t=new Date(s.getTime()+3*60*60*1e3);return w.value.some(o=>{const n=new Date(`${o.date_of_booking}T${o.time_of_booking}:00`),a=new Date(n.getTime()+3*60*60*1e3);return o.slot_number===r.slot_number&&n<t&&s<a})}),R=async s=>{var n;if(!s||!((n=b.shop)!=null&&n.id))return;const t=[new Date(s),new Date(s).setDate(new Date(s).getDate()-1),new Date(s).setDate(new Date(s).getDate()+1)].map(a=>new Date(a).toISOString().split("T")[0]),o=[];for(const a of[...new Set(t)])try{const D=await H.get(`/shops/${b.shop.id}/availability?date=${a}`);o.push(...D.data.bookings)}catch{}w.value=o.filter((a,D,M)=>D===M.findIndex(q=>q.date_of_booking===a.date_of_booking&&q.time_of_booking===a.time_of_booking&&q.slot_number===a.slot_number))},N=()=>A.visit(route("dashboard")),Q=()=>{var s;if(h.value="",_.value="",!((s=b.shop)!=null&&s.id)){h.value="Invalid shop ID";return}if(B.value){_.value="This slot is already booked";return}r.post(`/customer/book/${b.shop.id}/payment`)},W=window.location.origin;function U(s){var t;return(t=s.logo)!=null&&t.startsWith("http")?s.logo:`/storage/${s.logo}`||"/images/default-carwash.png"}function E(s){const t=s.target;t&&(t.src=`${W}/images/default-carwash.png`)}C(()=>r.date_of_booking,R),C(()=>b.shop,s=>{s!=null&&s.id&&r.date_of_booking&&R(r.date_of_booking)});function F(s){const t=s.target;t.value=t.value.replace(/\D/g,"").slice(0,11),r.contact_no=t.value}const X=x(()=>{const s=new Date,t=s.getFullYear(),o=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0");return`${t}-${o}-${n}`}),y=v("00:00");return C(()=>r.date_of_booking,s=>{if(!s)return;const t=new Date;if(new Date(s).toDateString()===t.toDateString()){const n=t.getHours().toString().padStart(2,"0"),a=t.getMinutes().toString().padStart(2,"0");y.value=`${n}:${a}`,r.time_of_booking<y.value&&(r.time_of_booking=y.value)}else y.value="00:00"},{immediate:!0}),(s,t)=>(i(),l(T,null,[k.value?(i(),l("div",G,[e("img",{src:S.value,alt:"QR Code Preview",class:"max-h-[80vh] rounded-xl shadow-2xl border-4 border-white"},null,8,J),e("button",{onClick:t[0]||(t[0]=o=>k.value=!1),class:"absolute top-6 right-8 text-white text-3xl font-bold"}," ✕ ")])):p("",!0),e("div",K,[s.shop?(i(),l("div",Z,[e("div",ee,[e("h1",te,"Book at "+c(s.shop.name),1),h.value?(i(),l("div",se,c(h.value),1)):p("",!0),_.value?(i(),l("div",oe,c(_.value),1)):p("",!0),e("form",{onSubmit:P(Q,["prevent"]),class:"space-y-4"},[e("div",null,[t[15]||(t[15]=e("label",{class:"block text-gray-700 font-medium"},[e("span",{class:"text-red-600"},"*"),u(" Name "),e("span",{class:"text-gray-500"},"(Required)")],-1)),m(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=o=>d(r).name=o),placeholder:"Your Name",class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:""},null,512),[[f,d(r).name]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-gray-700 font-medium"},[e("span",{class:"text-red-600"},"*"),u(" Email "),e("span",{class:"text-gray-500"},"(Required)")],-1)),m(e("input",{type:"email","onUpdate:modelValue":t[2]||(t[2]=o=>d(r).email=o),placeholder:"Email Address",class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:""},null,512),[[f,d(r).email]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-gray-700 font-medium"},[e("span",{class:"text-red-600"},"*"),u(" Car Type "),e("span",{class:"text-gray-500"},"(Required)")],-1)),m(e("select",{"onUpdate:modelValue":t[3]||(t[3]=o=>d(r).size_of_the_car=o),class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:""},[...t[17]||(t[17]=[e("option",{value:""},"Select Car Type",-1),e("option",null,"HatchBack",-1),e("option",null,"Sedan",-1),e("option",null,"MPV",-1),e("option",null,"SUV",-1),e("option",null,"Pickup",-1),e("option",null,"Van",-1),e("option",null,"Motorcycle",-1)])],512),[[L,d(r).size_of_the_car]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-gray-700 font-medium"},[e("span",{class:"text-red-600"},"*"),u(" Contact Number "),e("span",{class:"text-gray-500"},"(Required)")],-1)),m(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=o=>d(r).contact_no=o),placeholder:"09XXXXXXXXX",class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:"",maxlength:"11",onInput:F},null,544),[[f,d(r).contact_no]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-gray-700 font-medium"},[e("span",{class:"text-red-600"},"*"),u(" Date of Booking "),e("span",{class:"text-gray-500"},"(Required)")],-1)),m(e("input",{type:"date","onUpdate:modelValue":t[5]||(t[5]=o=>d(r).date_of_booking=o),class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:"",min:X.value},null,8,re),[[f,d(r).date_of_booking]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-gray-700 font-medium"},[e("span",{class:"text-red-600"},"*"),u(" Time of Booking "),e("span",{class:"text-gray-500"},"(Required)")],-1)),m(e("input",{type:"time","onUpdate:modelValue":t[6]||(t[6]=o=>d(r).time_of_booking=o),class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:"",min:y.value},null,8,ne),[[f,d(r).time_of_booking]])]),e("div",le,[t[22]||(t[22]=e("label",{for:"slot_number",class:"block text-gray-700 font-medium"},[e("span",{class:"text-red-600"},"*"),u(" Slot Number "),e("span",{class:"text-gray-500"},"(Required)")],-1)),m(e("input",{id:"slot_number",type:"number","onUpdate:modelValue":t[7]||(t[7]=o=>d(r).slot_number=o),min:"1",max:"4",class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",required:""},null,512),[[f,d(r).slot_number]]),e("p",ie,"Selected: Slot "+c(d(r).slot_number||1),1)]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-gray-700 font-medium mb-1"},[e("span",{class:"text-red-600"},"*"),u(" Services Offered "),e("span",{class:"text-gray-500"},"(Required)")],-1)),s.shop.services_offered?(i(),l("div",ae,[s.shop.services_offered.match(/\.(jpg|jpeg|png|gif|webp)$/i)||s.shop.services_offered.startsWith("http")?(i(),l("div",de,[e("img",{src:s.shop.services_offered.startsWith("http")?s.shop.services_offered:`/storage/${s.shop.services_offered}`,alt:"Services Offered",class:"h-24 w-24 object-contain rounded border cursor-pointer hover:scale-105 transition",onClick:t[8]||(t[8]=o=>g(s.shop.services_offered.startsWith("http")?s.shop.services_offered:`/storage/${s.shop.services_offered}`))},null,8,ue)])):(i(),l("p",ce,c(s.shop.services_offered),1))])):(i(),l("div",pe,"No services listed")),t[24]||(t[24]=e("label",{class:"block text-gray-700 font-medium mt-3"},[e("span",{class:"text-red-600"},"*"),u(" Services Requested "),e("span",{class:"text-gray-500"},"(Required)")],-1)),m(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=o=>d(r).services_offered=o),class:"w-full p-2 border rounded focus:ring-2 focus:ring-[#002B5C]",placeholder:"Specify services you want",rows:"3",required:""},null,512),[[f,d(r).services_offered]]),d(r).errors.services_offered?(i(),l("div",me,c(d(r).errors.services_offered),1)):p("",!0)]),d(r).date_of_booking?(i(),l("div",fe,[e("h3",ge,"Taken Slots on "+c(j.value)+" (View Only)",1),e("div",be,[$.value.length?(i(),l("table",ve,[t[26]||(t[26]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",null,"Time"),e("th",null,"Slot"),e("th",null,"Status")])],-1)),e("tbody",null,[(i(!0),l(T,null,z($.value,o=>(i(),l("tr",{key:`${o.time}-${o.slot}-${o.id||0}`,class:"bg-red-50 border-l-4 border-red-400"},[e("td",ye,c(o.time),1),e("td",he,"#"+c(o.slot),1),t[25]||(t[25]=e("td",{class:"px-2 py-1 text-sm text-red-600 font-semibold"},"Taken",-1))]))),128))])])):(i(),l("p",_e,"No taken slots yet."))])])):p("",!0),e("button",{type:"button",onClick:N,class:"w-full bg-gray-500 text-white py-2 rounded hover:bg-gray-600 transition"},"Return"),e("button",{type:"submit",class:"w-full bg-[#FF2D2D] text-white py-2 rounded hover:bg-red-700 transition",disabled:d(r).processing||B.value},"Pay Now",8,xe)],32)]),e("div",ke,[t[33]||(t[33]=e("h2",{class:"text-lg font-semibold text-[#002B5C mb-2"},"Shop Details",-1)),e("div",we,[e("img",{src:U(s.shop),alt:"Car Wash Logo",class:"h-20 w-20 object-contain mb-2",onError:E},null,40,De)]),e("p",null,[t[27]||(t[27]=e("span",{class:"font-semibold"},"Name:",-1)),u(" "+c(s.shop.name),1)]),e("p",null,[t[28]||(t[28]=e("span",{class:"font-semibold"},"Address:",-1)),u(" "+c(s.shop.address),1)]),e("p",null,[t[29]||(t[29]=e("span",{class:"font-semibold"},"District:",-1)),u(" "+c(s.shop.district||"Not specified"),1)]),e("p",null,[t[30]||(t[30]=e("span",{class:"font-semibold"},"Description:",-1)),u(" "+c(s.shop.description||"No description"),1)]),s.shop&&(s.shop.qr_code||s.shop.qr_code2||s.shop.qr_code3||s.shop.qr_code4||s.shop.qr_code5)?(i(),l("div",qe,[t[32]||(t[32]=e("h3",{class:"text-sm font-semibold text-gray-700 mb-2"},"QR Codes",-1)),e("div",Ce,[e("table",Se,[t[31]||(t[31]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-3 py-2 text-center"},"QR Code 1"),e("th",{class:"px-3 py-2 text-center"},"QR Code 2"),e("th",{class:"px-3 py-2 text-center"},"QR Code 3"),e("th",{class:"px-3 py-2 text-center"},"QR Code 4"),e("th",{class:"px-3 py-2 text-center"},"QR Code 5")])],-1)),e("tbody",null,[e("tr",null,[e("td",$e,[s.shop.qr_code?(i(),l("img",{key:0,src:s.shop.qr_code,alt:"QR Code 1",class:"h-12 w-12 object-cover rounded border mx-auto cursor-pointer hover:scale-105 transition",onClick:t[10]||(t[10]=o=>g(s.shop.qr_code))},null,8,Be)):p("",!0)]),e("td",Re,[s.shop.qr_code2?(i(),l("img",{key:0,src:s.shop.qr_code2,alt:"QR Code 2",class:"h-12 w-12 object-cover rounded border mx-auto cursor-pointer hover:scale-105 transition",onClick:t[11]||(t[11]=o=>g(s.shop.qr_code2))},null,8,Te)):p("",!0)]),e("td",Ve,[s.shop.qr_code3?(i(),l("img",{key:0,src:s.shop.qr_code3,alt:"QR Code 3",class:"h-12 w-12 object-cover rounded border mx-auto cursor-pointer hover:scale-105 transition",onClick:t[12]||(t[12]=o=>g(s.shop.qr_code3))},null,8,je)):p("",!0)]),e("td",Ne,[s.shop.qr_code4?(i(),l("img",{key:0,src:s.shop.qr_code4,alt:"QR Code 4",class:"h-12 w-12 object-cover rounded border mx-auto cursor-pointer hover:scale-105 transition",onClick:t[13]||(t[13]=o=>g(s.shop.qr_code4))},null,8,Qe)):p("",!0)]),e("td",We,[s.shop.qr_code5?(i(),l("img",{key:0,src:s.shop.qr_code5,alt:"QR Code 5",class:"h-12 w-12 object-cover rounded border mx-auto cursor-pointer hover:scale-105 transition",onClick:t[14]||(t[14]=o=>g(s.shop.qr_code5))},null,8,Ue)):p("",!0)])])])])])])):p("",!0)])])):(i(),l("div",Ee,"Shop not found."))]),e("footer",Fe,[t[37]||(t[37]=Y('<div class="max-w-6xl mx-auto grid grid-cols-1 sm:grid-cols-2 gap-6"><div><h2 class="text-lg font-bold text-white mb-3">About WashWise</h2><p class="text-sm leading-relaxed"> WashWise is your trusted platform for booking car wash services — connecting customers and business owners for a smoother, cleaner experience every day. </p></div><div><h2 class="text-lg font-bold text-white mb-3">Contact Us</h2><ul class="text-sm space-y-1"><li>📞 +63 992 759 4673</li><li>✉️ washwise00@gmail.com</li></ul></div></div>',1)),e("div",Xe,[u(" © "+c(new Date().getFullYear())+" WashWise. All rights reserved. ",1),t[34]||(t[34]=e("br",{class:"sm:hidden"},null,-1)),t[35]||(t[35]=u(" Developed by ",-1)),t[36]||(t[36]=e("span",{class:"text-[#FF2D2D] font-semibold"},"Washwise Team.",-1))])])],64))}});export{Ie as default};
